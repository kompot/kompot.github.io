(this["webpackJsonpfintrack-client-only"]=this["webpackJsonpfintrack-client-only"]||[]).push([[0],{292:function(e,t,n){e.exports=n(438)},297:function(e,t,n){},298:function(e,t,n){},300:function(e,t,n){},438:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(73),i=n.n(r),o=(n(297),n(14)),c=n(23),u=n(12),d=n(55),s=n(491),m=(n(298),n(20)),v=n(57),E=n(36),f=n(139),p=n(7),b=Object(f.a)({id:"form",initial:"idle",states:{idle:{on:{SUBMIT:"submitting"}},validating:{},submitting:{entry:Object(p.b)((function(e,t){return console.log("e",t,"---context.form.getValues();",e.form.getValues()),console.log("======"),{}})),on:{"":"submitted"}},submitted:{on:{REINIT:"idle"}}}}),g=["CURRENCY","CRYPTO_CURRENCY","SECURITY","VALUABLE_ASSET","PRECIOUS_METAL"],h=["BANK","BROKER","PERSON","PHYSICAL_LOCATION","E-WALLET","OTHER"],y=(n(300),function(e){var t=e.children;return(l.a.createElement("table",{className:"_3-1r7"},t))}),S=function(e){var t=e.children;return(l.a.createElement("tr",{className:"_3Mjlo"},t))},A=function(e){var t=e.children,n=e.colspan;return(l.a.createElement("td",{className:"zX0YF",colSpan:n},t))},O=function(e){var t=e.children,n=e.colspan;return(l.a.createElement("th",{className:"_1rfFa",colSpan:n},t))},T=n(30),I=n.n(T);function x(e,t,n,a){return null===e||void 0===e?void 0:e.data.assetAccountStates.filter((function(e){return e.reportId===t.id})).reduce((function(l,r){var i,o=e.data.assetAccounts.find((function(e){return e.id===r.assetAccountId})),c=e.data.assets.find((function(e){return e.id===o.assetId}));if(void 0!==a&&!a(c))return Math.round(l);var u=null===(i=e.data.exchangeRates.find((function(e){return e.reportId===t.id})))||void 0===i?void 0:i.data,d=function(e,t,n,a){if(void 0===t)return 0;var l="CURRENCY"===n.class,r=l?n:null===e||void 0===e?void 0:e.data.assets.find((function(e){return"CURRENCY"===e.class&&e.name===n.currency})),i=1;if(r.currency!==a){var o=null===e||void 0===e?void 0:e.data.assets.find((function(e){return"CURRENCY"===e.class&&e.name===a}));if(void 0!==o){var c=t[o.id];i=null!==c?parseFloat(c):0}}return 0===i?0:parseFloat(t[r.id]||"0")/i*(l?1:parseFloat(t[n.id]||"0"))}(e,u,c,n)*parseFloat(r.balance);return Math.round(d+l)}),0)}function R(e){return I.a.sortBy(null===e||void 0===e?void 0:e.data.institutions,(function(e){return e.sortIndex||e.name}))}function j(e){var t;return null===(t=R(e))||void 0===t?void 0:t.flatMap((function(t){return I.a.sortBy(null===e||void 0===e?void 0:e.data.assetAccounts.filter((function(e){return e.institutionId===t.id})),(function(e){return e.name}))}))}var C,D=function(e){var t,n=Object(a.useContext)(fe),r=j(n);if(void 0===r)return null;var i=I.a.sortBy(null===n||void 0===n?void 0:n.data.reports,(function(e){return-1*e.datetime})),o=null===n||void 0===n?void 0:n.data.assets;i[0];return l.a.createElement("div",null,l.a.createElement("h1",null,"Your net worth is..."),l.a.createElement(y,null,l.a.createElement("thead",null,l.a.createElement(S,null,l.a.createElement(O,null),null===(t=R(n))||void 0===t?void 0:t.map((function(e){return l.a.createElement(O,{colspan:r.filter((function(t){return t.institutionId===e.id})).length},e.name)}))),l.a.createElement(S,null,l.a.createElement(O,null,"date"),r.map((function(e){return l.a.createElement(O,null,e.name)})),l.a.createElement(O,null,"Total in RUB"),l.a.createElement(O,null,"Total in USD"),l.a.createElement(O,null,"Total in EUR"))),l.a.createElement("tbody",null,null===i||void 0===i?void 0:i.map((function(t){var a=null===n||void 0===n?void 0:n.data.assetAccountStates.filter((function(e){return e.reportId===t.id}));return(l.a.createElement(S,{key:t.id},l.a.createElement(A,null,l.a.createElement(c.b,{to:"/add-edit-report/".concat(t.id)},new Date(t.datetime).toISOString().substr(0,10))),r.map((function(e){var t=null===a||void 0===a?void 0:a.find((function(t){return t.assetAccountId===e.id}));return(l.a.createElement(A,null,null===t||void 0===t?void 0:t.balance))})),l.a.createElement(A,null,x(n,t,"RUB")),l.a.createElement(A,null,x(n,t,"USD")),l.a.createElement(A,null,x(n,t,"EUR")),l.a.createElement(A,null,l.a.createElement("button",{onClick:function(){var n;n=t.id,e.storeService.send("UPDATE_DATA",{actionType:"delete",entity:"reports",data:{id:n}})}},"delete"))))})))),l.a.createElement("h2",null,"Exchange rates"),l.a.createElement(y,null,l.a.createElement("thead",null,l.a.createElement(S,null,l.a.createElement(O,null,"date"),null===o||void 0===o?void 0:o.map((function(e){return l.a.createElement(O,null,e.class," ",e.subclass," ",e.name," in ",e.currency)})))),l.a.createElement("tbody",null,null===i||void 0===i?void 0:i.map((function(t){var a=null===n||void 0===n?void 0:n.data.exchangeRates.find((function(e){return e.reportId===t.id}));return(l.a.createElement(S,{key:t.id},l.a.createElement(A,null,new Date(t.datetime).toISOString().substr(0,10)),null===o||void 0===o?void 0:o.map((function(n){var r,i=null===a||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r[n.id];return l.a.createElement(A,null,l.a.createElement("input",{style:{width:50},defaultValue:i,onChange:function(a){return function(t,n,a){console.log("_________value",t,n,a),e.storeService.send({type:"UPDATE_DATA",actionType:"update",entity:"exchangeRates",data:{value:t,asset:n,report:a}})}(a.target.value,n,t)}}))}))))})))))},w=E.d((C={},Object(m.a)(C,"type",E.e().required("required")),Object(m.a)(C,"name",E.e().required("required")),Object(m.a)(C,"sortIndex",E.c().integer().moreThan(-1,"required posititve number").required("required")),C)),U=function(e){var t,n,r,i,c=e.storeService,u=Object(a.useContext)(fe),s=Object(v.a)({validationSchema:w}),m=Object(d.useMachine)(b,{devTools:!0,context:{form:s}}),E=Object(o.a)(m,2),f=E[0],p=E[1];return Object(a.useEffect)((function(){f.matches("submitted")&&(c.send("UPDATE_DATA",{actionType:"create",entity:"institutions",data:w.validateSync(f.context.form.getValues())}),p("REINIT"))}),[f,p,c]),l.a.createElement("div",{className:"_2kclh"},l.a.createElement("h1",null,"Institutions ",null===u||void 0===u?void 0:null===(t=u.data.institutions)||void 0===t?void 0:t.length),l.a.createElement("form",{onSubmit:s.handleSubmit((function(e){console.log("________",e),p("SUBMIT")}))},l.a.createElement(y,null,l.a.createElement("thead",null,l.a.createElement(S,null,l.a.createElement(O,{colspan:3}),l.a.createElement(O,null,"Used in # of"),l.a.createElement(O,null)),l.a.createElement(S,null,l.a.createElement(O,null,"ID"),l.a.createElement(O,null,"type"),l.a.createElement(O,null,"name"),l.a.createElement(O,null,"sort index"),l.a.createElement(O,null,"asset accounts"),l.a.createElement(O,null,"action"))),l.a.createElement("tbody",null,l.a.createElement(S,null,l.a.createElement(A,null),l.a.createElement(A,null,l.a.createElement("select",{name:"type",ref:s.register({required:"Required"})},h.map((function(e){return l.a.createElement("option",{value:e},e)})))),l.a.createElement(A,null,l.a.createElement("input",{name:"name",ref:s.register({required:"Required"})}),null===(n=s.errors.name)||void 0===n?void 0:n.message),l.a.createElement(A,null,l.a.createElement("input",{name:"sortIndex",ref:s.register({required:"Required"})}),null===(r=s.errors.sortIndex)||void 0===r?void 0:r.message),l.a.createElement(A,null),l.a.createElement(A,null,l.a.createElement("button",{type:"submit"},"Save"))),null===u||void 0===u?void 0:null===(i=u.data.institutions)||void 0===i?void 0:i.map((function(e){var t=j(u).filter((function(t){return t.institutionId===e.id}));return(l.a.createElement(S,{key:e.id},l.a.createElement(A,null,e.id),l.a.createElement(A,null,e.type),l.a.createElement(A,null,e.name),l.a.createElement(A,null,e.sortIndex),l.a.createElement(A,null,t.length),l.a.createElement(A,null,0===t.length&&l.a.createElement("button",{type:"button",onClick:function(){return t=e.id,void c.send({type:"UPDATE_DATA",actionType:"delete",entity:"institutions",data:{id:t}});var t}},"delete"))))}))))))},k=n(59),_=n(109),B=n(254),q=n(232),N=n.n(q),L=n(233),Y=n.n(L),F=Object(f.a)({id:"fetch",initial:"idle",context:{url:"",data:null,error:null,retries:0,maxRetries:3},states:{idle:{on:{FETCH:"loading"}},loading:{invoke:{src:"fetch",onDone:{target:"success",actions:["setData","notifyData",Object(p.r)("LOADED")]},onError:{target:"failure",actions:["setError","notifyError"]}}},success:{on:{REFETCH:{target:"loading",actions:"resetRetries"}}},failure:{on:{"":{target:"fatal",cond:"canNotRetry"},RETRY:{target:"loading",actions:"incrementRetries"}}},fatal:{type:"final"}}},{guards:{canNotRetry:function(e){return e.retries===e.maxRetries}},actions:{setData:Object(p.b)({data:function(e,t){return t.data}}),notifyData:function(){console.log("-----notifydata")},setError:Object(p.b)({error:function(e,t){return t.data}}),notifyError:function(){},incrementRetries:Object(p.b)({retries:function(e){return e.retries+1}})},services:{fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return fetch(e.url).then((function(e){return e.json()})).then((function(e){return e}))}))}}),M=Object(B.a)("ABCDEFGHJKLMNPQRSTUVWXYZ123456789",6),P=function(e){var t=new Date(e);return Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())},V=Object(f.a)({key:"store",initial:"idle",context:{db:null,urlDataToSave:void 0,fetchRef:null},entry:Object(p.b)({fetchRef:function(){return Object(_.c)(F.withContext({url:"/data.json",maxRetries:4,data:null,error:null,retries:0}),{name:"fetch"})}}),states:{idle:{on:{LOAD:{actions:Object(p.q)("FETCH",{to:"fetch"})},LOADED:"loaded"}},loaded:{entry:Object(p.b)((function(e,t){void 0!==e.urlDataToSave&&window.URL.revokeObjectURL(e.urlDataToSave);var n=N()(new Y.a(""));return n.setState(e.fetchRef._state.context.data),{db:n,urlDataToSave:void 0}})),on:{SAVE:"saving",UPDATE_DATA:"updating_data"}},saving:{entry:Object(p.b)((function(e,t){var n,a;return console.log("-=====ctx.data",null===(n=e.db)||void 0===n?void 0:n.getState()),{urlDataToSave:window.URL.createObjectURL(new Blob([JSON.stringify(null===(a=e.db)||void 0===a?void 0:a.getState(),null,2)],{type:"text/plain"}))}})),on:{SAVED:"loaded"}},updating_data:{entry:Object(p.b)((function(e,t){if("create"===t.actionType)if("assetAccountStates"===t.entity){var n,a=M();null===(n=e.db)||void 0===n||n.get("data").get("reports").push({id:a,datetime:P(t.data.date)}).write(),t.data.assetAccountStates.forEach((function(t){var n;null===(n=e.db)||void 0===n||n.get("data").get("assetAccountStates").push(Object(k.a)(Object(k.a)({},t),{},{reportId:a})).write()}))}else{var l,r;null===(l=e.db)||void 0===l||null===(r=l.get("data"))||void 0===r||r.get(t.entity).push(Object(k.a)({id:M()},t.data)).write()}else if("update"===t.actionType){if("exchangeRates"===t.entity){var i,o=null===(i=e.db)||void 0===i?void 0:i.get("data").get("exchangeRates"),c=null===o||void 0===o?void 0:o.find((function(e){return e.reportId===t.data.report.id}));if(void 0!==(null===c||void 0===c?void 0:c.value()))c.get("data").set(t.data.asset.id,t.data.value).write();else{var u={id:M(),reportId:t.data.report.id,data:Object(m.a)({},t.data.asset.id,t.data.value)};null===o||void 0===o||o.push(u).write()}}if("assetAccountStates"===t.entity){var d,s,v=null===(d=e.db)||void 0===d?void 0:d.get("data").get("reports"),E=null===v||void 0===v?void 0:v.find((function(e){return e.id===t.data.reportId}));null===E||void 0===E||E.set("datetime",P(t.data.date)).write();var f=[];null===(s=e.db)||void 0===s||s.get("data").get("assetAccountStates").forEach((function(e){var n;e.reportId===t.data.reportId&&(e.balance=null===(n=t.data.assetAccountStates.find((function(t){return t.assetAccountId===e.assetAccountId})))||void 0===n?void 0:n.balance,f.push(e.assetAccountId))})).write(),t.data.assetAccountStates.filter((function(e){return!f.includes(e.assetAccountId)})).forEach((function(n){var a;null===(a=e.db)||void 0===a||a.get("data").get("assetAccountStates").push(Object(k.a)(Object(k.a)({},n),{},{reportId:t.data.reportId})).write()}))}}else{if("delete"!==t.actionType)throw new Error("How did you end up here?");var p,b,g,h,y,S;"institutions"===t.entity&&(null===(p=e.db)||void 0===p||p.get("data").get("institutions").remove((function(e){return e.id===t.data.id})).write());"assets"===t.entity&&(null===(b=e.db)||void 0===b||b.get("data").get("assets").remove((function(e){return e.id===t.data.id})).write());"assetAccounts"===t.entity&&(null===(g=e.db)||void 0===g||g.get("data").get("assetAccounts").remove((function(e){return e.id===t.data.id})).write());"reports"===t.entity&&(null===(h=e.db)||void 0===h||h.get("data").get("reports").remove((function(e){return e.id===t.data.id})).write(),null===(y=e.db)||void 0===y||y.get("data").get("assetAccountStates").remove((function(e){return e.reportId===t.data.id})).write(),null===(S=e.db)||void 0===S||S.get("data").get("exchangeRates").remove((function(e){return e.reportId===t.data.id})).write())}return{}})),on:{"":"loaded"}}}}),H=function(e){var t,n,r,i,c,u=e.storeService,s=Object(a.useContext)(fe),m=Object(v.a)(),E=Object(d.useMachine)(b,{devTools:!0,context:{form:m}}),f=Object(o.a)(E,2),p=f[0],h=f[1];Object(a.useEffect)((function(){p.matches("submitted")&&(u.send("UPDATE_DATA",{actionType:"create",entity:"assets",data:p.context.form.getValues()}),h("REINIT"))}),[p,h,u]);return l.a.createElement("div",null,l.a.createElement("h1",null,"Assets ",null===s||void 0===s?void 0:null===(t=s.data.assets)||void 0===t?void 0:t.length),l.a.createElement("form",{onSubmit:m.handleSubmit((function(e){h("SUBMIT")}))},l.a.createElement(y,null,l.a.createElement("thead",null,l.a.createElement(S,null,l.a.createElement(O,{colspan:5}),l.a.createElement(O,null,"Used in # of")),l.a.createElement(S,null,l.a.createElement(O,null,"ID"),l.a.createElement(O,null,"class"),l.a.createElement(O,null,"subclass"),l.a.createElement(O,null,"name"),l.a.createElement(O,null,"currency"),l.a.createElement(O,null,"asset accounts"))),l.a.createElement("tbody",null,l.a.createElement(S,null,l.a.createElement(A,null),l.a.createElement(A,null,l.a.createElement("select",{name:"class",ref:m.register({required:"Required"})},g.map((function(e){return l.a.createElement("option",{value:e},e)})))),l.a.createElement(A,null,l.a.createElement("input",{name:"subclass",ref:m.register({required:"Required"})}),null===(n=m.errors.subclass)||void 0===n?void 0:n.message),l.a.createElement(A,null,l.a.createElement("input",{name:"name",ref:m.register({required:"Required"})}),l.a.createElement("br",null),null===(r=m.errors.name)||void 0===r?void 0:r.message),l.a.createElement(A,null,l.a.createElement("input",{name:"currency",ref:m.register({required:"Required"})}),l.a.createElement("br",null),null===(i=m.errors.currency)||void 0===i?void 0:i.message),l.a.createElement(A,null),l.a.createElement(A,null,l.a.createElement("button",{type:"submit"},"Save"))),null===s||void 0===s?void 0:null===(c=s.data.assets)||void 0===c?void 0:c.map((function(e){var t,n=null===(t=j(s))||void 0===t?void 0:t.filter((function(t){return t.assetId===e.id}));return l.a.createElement(S,{key:e.id},l.a.createElement(A,null,e.id),l.a.createElement(A,null,e.class),l.a.createElement(A,null,e.subclass),l.a.createElement(A,null,e.name),l.a.createElement(A,null,e.currency),l.a.createElement(A,null,n.length),l.a.createElement(A,null,0===n.length&&l.a.createElement("button",{type:"button",onClick:function(){return t=e.id,void u.send({type:"UPDATE_DATA",actionType:"delete",entity:"assets",data:{id:t}});var t}},"delete")))}))))))},W=function(e){var t,n,r,i=e.storeService,c=Object(a.useContext)(fe),u=Object(v.a)(),s=Object(d.useMachine)(b,{devTools:!0,context:{form:u}}),m=Object(o.a)(s,2),E=m[0],f=m[1];Object(a.useEffect)((function(){E.matches("submitted")&&(i.send("UPDATE_DATA",{actionType:"create",entity:"assetAccounts",data:E.context.form.getValues()}),f("REINIT"))}),[E,f,i]);return l.a.createElement("div",null,l.a.createElement("h1",null,"Asset accounts ",null===(t=j(c))||void 0===t?void 0:t.length),l.a.createElement("form",{onSubmit:u.handleSubmit((function(e){f("SUBMIT")}))},l.a.createElement(y,null,l.a.createElement("thead",null,l.a.createElement(S,null,l.a.createElement(O,{colspan:4}),l.a.createElement(O,null,"Used in # of")),l.a.createElement(S,null,l.a.createElement(O,null,"id"),l.a.createElement(O,null,"asset"),l.a.createElement(O,null,"institution"),l.a.createElement(O,null,"name"),l.a.createElement(O,null,"reports"))),l.a.createElement("tbody",null,l.a.createElement(S,null,l.a.createElement(A,null),l.a.createElement(A,null,l.a.createElement("select",{name:"assetId",ref:u.register({required:"Required"})},null===c||void 0===c?void 0:c.data.assets.map((function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.class," ",e.subclass," ",e.name)})))),l.a.createElement(A,null,l.a.createElement("select",{name:"institutionId",ref:u.register({required:"Required"})},null===c||void 0===c?void 0:c.data.institutions.map((function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.type," ",e.name)})))),l.a.createElement(A,null,l.a.createElement("input",{name:"name",ref:u.register({required:"Required"})}),l.a.createElement("br",null),null===(n=u.errors.name)||void 0===n?void 0:n.message),l.a.createElement(A,null),l.a.createElement(A,null,l.a.createElement("button",{type:"submit"},"Save"))),null===(r=j(c))||void 0===r?void 0:r.map((function(e){var t,n;if(void 0===c)return null;var a=null===c||void 0===c?void 0:c.data.assetAccountStates.filter((function(t){return t.assetAccountId===e.id}));return(l.a.createElement(S,{key:e.id},l.a.createElement(A,null,e.id),l.a.createElement(A,null,null===(t=c.data.assets.find((function(t){return t.id===e.assetId})))||void 0===t?void 0:t.name),l.a.createElement(A,null,null===(n=c.data.institutions.find((function(t){return t.id===e.institutionId})))||void 0===n?void 0:n.name),l.a.createElement(A,null,e.name),l.a.createElement(A,null,a.length),l.a.createElement(A,null,0===a.length&&l.a.createElement("button",{type:"button",onClick:function(){return t=e.id,void i.send({type:"UPDATE_DATA",actionType:"delete",entity:"assetAccounts",data:{id:t}});var t}},"delete"))))}))))))},z=E.d({date:E.b().required("\u0434\u0430\u0442\u0430!"),assetAccountStates:E.a().of(E.d({balance:E.e().required("\u0437\u0430\u043f\u043e\u043b\u043d\u044f\u0439, \u0441\u0443\u043a\u0430"),assetAccountId:E.e().required("\u0437\u0430\u043f\u043e\u043b\u043d\u044f\u0439, \u0441\u0443\u043a\u0430")}))}),X=function(e){var t,n,r,i,o,c=e.storeService,d=Object(a.useContext)(fe),s=Object(u.h)(),m=j(d);if(void 0!==s.reportId){i=null===d||void 0===d?void 0:d.data.reports.find((function(e){return e.id===s.reportId}));var E=null===d||void 0===d?void 0:d.data.assetAccountStates.filter((function(e){var t;return e.reportId===(null===(t=i)||void 0===t?void 0:t.id)}));o=I.a.sortBy(E,(function(e){return null===m||void 0===m?void 0:m.findIndex((function(t){return t.id===e.assetAccountId}))}))}var f=Object(v.a)({validationSchema:z,defaultValues:{date:(null===(t=i)||void 0===t?void 0:t.datetime)?new Date(i.datetime).toISOString().substr(0,10):(new Date).toISOString().substr(0,10),assetAccountStates:o}}),p=Object(u.g)(),b=null===(n=I.a.maxBy(null===d||void 0===d?void 0:d.data.reports,(function(e){return e.datetime})))||void 0===n?void 0:n.id,g=null===d||void 0===d?void 0:d.data.assetAccountStates.filter((function(e){return e.reportId===b}));return l.a.createElement("div",null,l.a.createElement("h1",null,"Add report"),l.a.createElement("form",{onSubmit:f.handleSubmit((function(e){console.log("=====values",e.date,e),void 0===i?c.send({type:"UPDATE_DATA",actionType:"create",entity:"assetAccountStates",data:e}):c.send({type:"UPDATE_DATA",actionType:"update",entity:"assetAccountStates",data:Object(k.a)({reportId:i.id},e)}),p("/")}))},l.a.createElement("input",{type:"date",name:"date",ref:f.register}),null===(r=f.errors.date)||void 0===r?void 0:r.message,l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(y,null,l.a.createElement("thead",null,l.a.createElement(S,null,l.a.createElement(A,null),l.a.createElement(A,null,"New balance"),l.a.createElement(A,null,"Prev balance"))),l.a.createElement("tbody",null,null===m||void 0===m?void 0:m.map((function(e,t){var n,a,r,i,o,c,u,s=0===t||m[t].institutionId!==m[t-1].institutionId?l.a.createElement(S,{key:"header".concat(e.id)},l.a.createElement(A,{colspan:3},l.a.createElement("h3",null,null===(n=R(d))||void 0===n?void 0:null===(a=n.find((function(t){return t.id===e.institutionId})))||void 0===a?void 0:a.name))):null,v=l.a.createElement(S,{key:"data".concat(e.id)},l.a.createElement(A,null,e.name),l.a.createElement(A,null,l.a.createElement("input",{name:"assetAccountStates[".concat(t,"].balance"),ref:f.register}),l.a.createElement("input",{type:"hidden",name:"assetAccountStates[".concat(t,"].assetAccountId"),ref:f.register,value:e.id}),(null===(r=f.errors.assetAccountStates)||void 0===r?void 0:null===(i=r[t])||void 0===i?void 0:i.balance)&&(null===(o=f.errors.assetAccountStates)||void 0===o?void 0:null===(c=o[t])||void 0===c?void 0:c.balance).message),l.a.createElement(A,null,null===g||void 0===g?void 0:null===(u=g.find((function(t){return t.assetAccountId===e.id})))||void 0===u?void 0:u.balance));return l.a.createElement(l.a.Fragment,null,s,v)})))),l.a.createElement("button",{type:"submit"},"Submit")))},J=n(169),K=n(486),G=n(487),Q=n(245),Z=function(){var e=Object(a.useContext)(fe),t=Object(c.c)(),n=Object(o.a)(t,2),r=n[0],i=(n[1],["USD","EUR","RUB"]),u=r.get("yearsBack"),d={start:Object(Q.a)(Object(K.a)(new Date,-1*parseInt(null!==u&&void 0!==u?u:"0",10)),-2),end:new Date},s=null===e||void 0===e?void 0:e.data.reports.filter((function(e){return null===u||Object(G.a)(e.datetime,d)})),m=i.map((function(t){var n=I.a.compact(null===s||void 0===s?void 0:s.map((function(n){var a=new Date(n.datetime),l=a.getUTCFullYear()+"-"+I.a.padStart(String(a.getUTCMonth()+1),2,"0")+"-"+a.getUTCDate();return console.log("=====d.getUTCMonth() === 1",1===a.getUTCMonth(),x(e,n,t),l),{x:l,y:(x(e,n,t,(function(e){return e.name===t}))||0).toFixed(0)}})));return console.log("====allReportsInCurrency",n),{id:t,data:n||[]}})),v=i.map((function(t){var n=I.a.compact(null===s||void 0===s?void 0:s.map((function(n){var a=new Date(n.datetime),l=a.getUTCFullYear()+"-"+I.a.padStart(String(a.getUTCMonth()+1),2,"0")+"-"+a.getUTCDate();return console.log("=====d.getUTCMonth() === 1",1===a.getUTCMonth(),x(e,n,t),l),{x:l,y:(100*(x(e,n,t,(function(e){return e.name===t}))/x(e,n,t)||0)).toFixed(0)}})));return console.log("====allReportsInCurrency",n),{id:t,data:n||[]}}));console.log({data1:m});var E=function(e){return l.a.createElement(J.a,{animate:!1,data:[m[e]],margin:{top:50,right:110,bottom:50,left:60},xScale:{type:"time",format:"%Y-%m-%d"},xFormat:"time:%Y-%m-%d",yScale:{type:"linear",min:"auto",max:"auto",stacked:!0},axisTop:null,axisRight:null,axisBottom:{format:"%Y %m",tickValues:"every 4 months",legend:"\u0432\u0440\u0435\u043c\u044f",legendOffset:-12},axisLeft:{orient:"left",tickSize:5,tickPadding:5,tickRotation:0},pointSize:0,pointColor:{theme:"background"},pointBorderWidth:2,pointBorderColor:{from:"serieColor"},pointLabel:"y",pointLabelYOffset:-12,enableSlices:"x",useMesh:!0,legends:[{anchor:"bottom-right",direction:"column",justify:!1,translateX:100,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}],sliceTooltip:function(e){var t=e.slice;return console.log("------slice",t),l.a.createElement("div",{style:{background:"white",padding:"9px 12px",border:"1px solid #ccc"}},l.a.createElement("div",null,t.points[0].data.xFormatted),t.points.map((function(e){return l.a.createElement("div",{key:e.id,style:{color:e.serieColor,padding:"3px 0"}},l.a.createElement("strong",null,e.serieId)," ",e.data.yFormatted)})))}})};return(l.a.createElement("div",{style:{height:300}},l.a.createElement("h1",null,"Charts"),l.a.createElement("h6",null,l.a.createElement(c.b,{to:"?yearsBack=1"},"1 year")," |"," ",l.a.createElement(c.b,{to:"?yearsBack=2"},"2 year")," | ",l.a.createElement(c.b,{to:"."},"all")),l.a.createElement("div",{style:{width:"100%",height:300,display:"flex"}},l.a.createElement("div",{style:{width:"33%",height:300}},E(0)),l.a.createElement("div",{style:{width:"33%",height:300}},E(1)),l.a.createElement("div",{style:{width:"33%",height:300}},E(2))),l.a.createElement(J.a,{animate:!1,data:v,margin:{top:50,right:110,bottom:50,left:60},xScale:{type:"time",format:"%Y-%m-%d"},xFormat:"time:%Y-%m-%d",yScale:{type:"linear",min:"auto",max:"auto"},axisTop:null,axisRight:null,axisBottom:{format:"%Y %m",tickValues:"every 4 months",legend:"\u0432\u0440\u0435\u043c\u044f",legendOffset:-12},axisLeft:{orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:"%",legendOffset:-50,legendPosition:"middle"},pointSize:4,pointColor:{theme:"background"},pointBorderWidth:2,pointBorderColor:{from:"serieColor"},pointLabel:"y",pointLabelYOffset:-12,enableSlices:"x",useMesh:!0,legends:[{anchor:"bottom-right",direction:"column",justify:!1,translateX:100,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}],sliceTooltip:function(e){var t=e.slice;return console.log("------slice",t),l.a.createElement("div",{style:{background:"white",padding:"9px 12px",border:"1px solid #ccc"}},l.a.createElement("div",null,t.points[0].data.xFormatted),t.points.map((function(e){return l.a.createElement("div",{key:e.id,style:{color:e.serieColor,padding:"3px 0"}},l.a.createElement("strong",null,e.serieId)," ",e.data.yFormatted,"%")})))}})))},$=n(490),ee=n(492),te=n(251),ne=n.n(te),ae=n(252),le=n.n(ae),re=n(253),ie=n.n(re),oe=n(250),ce=n.n(oe),ue=n(488),de=n(494),se=n(495),me=Object(ue.a)((function(e){return Object(de.a)({text:{padding:e.spacing(2,2,0)},paper:{paddingBottom:50},list:{marginBottom:e.spacing(2)},subheader:{backgroundColor:e.palette.background.paper},appBar:{top:"auto",bottom:0},grow:{flexGrow:1},fabButton:{position:"absolute",zIndex:1,top:-30,left:0,right:0,margin:"0 auto"},fullList:{width:"auto"}})})),ve=I.a.values({0:"assets",1:"asset-accounts",2:"charts",3:"institutions"}),Ee=function(){var e=me(),t=Object(u.f)(),n=l.a.useState(void 0),r=Object(o.a)(n,2),i=r[0],d=r[1];return Object(a.useEffect)((function(){ve.some((function(e,n){return t.pathname.startsWith("/"+e)}))||d(void 0);var e=ve.findIndex((function(e){return t.pathname.startsWith("/"+e)}));-1!==e&&d(e)}),[t.pathname,i]),l.a.createElement(se.a,{position:"fixed",color:"primary",className:e.appBar},l.a.createElement($.a,{value:i,onChange:function(e,t){console.log({event:e,newValue:t}),d(t)},showLabels:!0},l.a.createElement(ee.a,{component:c.b,to:"assets",label:"Assets",icon:l.a.createElement(ce.a,null)}),l.a.createElement(ee.a,{component:c.b,to:"asset-accounts",label:"Asset accounts",icon:l.a.createElement(ne.a,null)}),l.a.createElement(ee.a,{component:c.b,to:"charts",label:"Charts",icon:l.a.createElement(le.a,null)}),l.a.createElement(ee.a,{component:c.b,to:"institutions",label:"Institutions",icon:l.a.createElement(ie.a,null)})))},fe=l.a.createContext(void 0),pe=function(){var e,t,n=Object(d.useMachine)(V,{devTools:!0}),r=Object(o.a)(n,3),i=r[0],m=r[1],v=r[2];return Object(a.useEffect)((function(){m("LOAD")}),[m]),console.log("-----!!",i.value,null===(e=i.context.db)||void 0===e?void 0:e.getState()),l.a.createElement(fe.Provider,{value:null===(t=i.context.db)||void 0===t?void 0:t.getState()},l.a.createElement(c.a,null,l.a.createElement(l.a.Fragment,null,l.a.createElement(s.a,null),l.a.createElement("div",{className:"_3QqL3"},l.a.createElement("div",{className:"_3m8Iv"},l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement(c.b,{to:"/"},"Home")),l.a.createElement("li",null,l.a.createElement(c.b,{to:"charts"},"Charts")),l.a.createElement("li",null,l.a.createElement(c.b,{to:"institutions"},"Institutions")),l.a.createElement("li",null,l.a.createElement(c.b,{to:"assets"},"Assets")),l.a.createElement("li",null,l.a.createElement(c.b,{to:"asset-accounts"},"Asset accounts")),l.a.createElement("li",null,l.a.createElement(c.b,{to:"add-edit-report"},"Add report"))),l.a.createElement("button",{onClick:function(){m("SAVE")}},"prepare data"),i.matches("saving")&&l.a.createElement("a",{href:i.context.urlDataToSave,download:"fintrack.json",onClick:function(){setTimeout((function(){m("SAVED")}),0)}},"download")),l.a.createElement("div",{className:"_2KOUX"},l.a.createElement(u.c,null,l.a.createElement(u.a,{path:"charts",element:l.a.createElement(Z,null)}),l.a.createElement(u.a,{path:"institutions",element:l.a.createElement(U,{storeService:v})}),l.a.createElement(u.a,{path:"assets",element:l.a.createElement(H,{storeService:v})}),l.a.createElement(u.a,{path:"asset-accounts",element:l.a.createElement(W,{storeService:v})}),l.a.createElement(u.a,{path:"add-edit-report/:reportId",element:l.a.createElement(X,{storeService:v})}),l.a.createElement(u.a,{path:"add-edit-report",element:l.a.createElement(X,{storeService:v})}),l.a.createElement(u.a,{element:l.a.createElement(D,{storeService:v})})))),l.a.createElement(Ee,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(pe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[292,1,2]]]);
//# sourceMappingURL=main.6e277eac.chunk.js.map